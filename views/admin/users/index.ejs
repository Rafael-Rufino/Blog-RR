<%- include("../../partials/header.ejs") %> 
<%- include("../../partials/navbar.ejs") %> 

<div class="container">
<br>
  <div class="card">
    <div class="card-header">
      <h1>Listagem de Usuários</h1>
      <br>
      <a class = "btn btn-success" href="/admin/users/create">Criar novo usuário</a>
      <br>
    </div>
    <div class="card-body">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Id</th>
            <th>E-mail</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          <% users.forEach(user => { %>
            <tr>
              <th><%= user.id %></th>
              <th><%= user.email %></th>
                    
        <th>
          
          <form
            method="POST"
            action="/users/delete"
            style="display: inline"
            onsubmit="confirmaDelecao(event, this)"
          >
            <input type="hidden" name="id" value="<%= user.id %> " />
            <button class="btn btn-danger">Deletar</button>
          </form>
        </th>

          <% }) %> 
          </tr>
        </tbody>
      </table>
    </div>
  </div>

</div>

<%- include("../../partials/footer.ejs") %> 
<script>
  function confirmaDelecao(event, form) {
    event.preventDefault();
    var decision = confirm("Você quer deletar este usuario?");
    if(decision){
      form.submit();
    }
    
    
  }
</script>